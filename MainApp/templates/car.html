{% extends "base.html" %} {% block body %}
<body class="body">
  <div class="page">
    <header class="header">
      <div class="header__left">
        <img
          src="{{ url_for('static', filename='images/header_logo.png') }}"
          class="header_logo"
          alt=""
        />
      </div>
      <div class="header__main">
        <a class="nav__link nav__link--header" href="{{ url_for('main.cars') }}"
          >Автомобили</a
        >
        <a
          class="nav__link nav__link--header"
          href="{{ url_for('main.spare') }}"
          >Запчасти</a
        >
        <a
          class="nav__link nav__link--header"
          href="{{ url_for('main.driver') }}"
          >Водители</a
        >
      </div>
      <form action="{{ url_for('main.profile') }}">
        <button class="header__right">
          <div class="profile__photo">
            <img
              src="{{ url_for('static', filename='images/profile_photo.svg') }}"
              alt=""
            />
          </div>
          <div class="profile__name">{{ name }}</div>
        </button>
      </form>
    </header>
    <div class="main">
      <div class="content">
{% with messages = get_flashed_messages() %} {% if messages %}
    <div class="notification is-danger">{{ messages[0] }}</div>
    {% endif %} {% endwith %}
      <div class="slider-wrapper">

          {% for f in AvtoPhoto %}
        <div class="slide">
          <img class="slide-img" src="{{url_for ('static',filename=f[1])}}">
          <form action="/delete?avto_id={{ avto.avto_id }}" method="post">
            <input type="submit" name="{{f[0]}}" value="{{f[1]}}">
          </form>
          </div>
          {% endfor %}
        <div class="dots-wrapper">

          {% for f in AvtoPhoto %}
        <span class="dot">
          <img class="img__dot" src="{{url_for ('static',filename=f[1])}}">
        </span>
          {% endfor %}

    </div>
        <div id="btn-prev">
                <img  src="{{ url_for('static', filename='images/arrow__left.svg') }}" alt="">
            </div>
            <div id="btn-next">
                <img   src="{{ url_for('static', filename='images/arrow__right.svg') }}" alt="">
            </div>
      </div>
        <form class="add__photo" action="/upload-photo?avto_id={{ avto.avto_id }}" method="post" enctype="multipart/form-data">
          <p>Звгрузить фото автомобиля:</p>
          <input class="btn_save__photo" type="submit" value="Сохранить">
          <input  class="input__file" type="file" name="file" >
        </form>

        <div class="car__info">
          <p>{{ avto.car_make }}</p>
          <p>{{ avto.car_model }}</p>
          <p>{{ avto.mileage }}</p>
          <p>{{ avto.years }}</p>
          <p>{{ avto.last_update.date() }}</p>
        </div>
      </div>

    </div>
  </div>
<script>
    const prev = document.getElementById('btn-prev'),
      next = document.getElementById('btn-next'),
      slides = document.querySelectorAll('.slide'),
      dots = document.querySelectorAll('.dot');

let index = 0;

const activeSlide = n => {
    for(slide of slides) {
        slide.classList.remove('active');
    }
    slides[n].classList.add('active');
}

const activeDot = n => {
    for(dot of dots) {
        dot.classList.remove('active');
    }
    dots[n].classList.add('active');
}

const prepareCurrentSlide = ind => {
    activeSlide(index);
    activeDot(index);
}

const nextSlide = () => {
    if(index == slides.length - 1) {
        index = 0;
        prepareCurrentSlide(index);
    }else {
        index++;
        prepareCurrentSlide(index);
    }
}

const prevSlide = () => {
    if(index == slides.length - 1) {
        index = 0;
        prepareCurrentSlide(index);
    }else {
        index--;
        prepareCurrentSlide(index);
    }
}

dots.forEach((item, indexDot)=> {
    item.addEventListener('click', () => {
        index = indexDot;
        prepareCurrentSlide(index);
    })
})

next.addEventListener('click', nextSlide);
prev.addEventListener('click', prevSlide);
</script>
</body>

{% endblock %}
